
$(function(){$('#diaperModal button').click(function(){trackEvent($('#diaperModal'),'Diaper',$(this).data('value'));return false;});});$(function(){var feedType;$('#feedModal').on('hidden.bs.modal',function(){$('#feedModal .feed-types button').removeClass('btn-primary').removeClass('btn-info').addClass('btn-info');$('#feedModal .bottle-options').addClass('hide');$('#feedModal .time-options').addClass('hide');});$('#feedModal .feed-types button').click(function(){$('#feedModal .feed-types button').removeClass('btn-primary').removeClass('btn-info').addClass('btn-info');$(this).removeClass('btn-info').addClass('btn-primary');if($(this).data('value')=='left'||$(this).data('value')=='right'){$('#feedModal .time-options').removeClass('hide');$('#feedModal .bottle-options').addClass('hide');}else{$('#feedModal .bottle-options').removeClass('hide');$('#feedModal .time-options').addClass('hide');}
feedType=$(this).data('value');return false;});$('#feedModal .time-options button, #feedModal .bottle-options button').click(function(){trackEvent($('#feedModal'),'Feed',feedType,$(this).data('value'));return false;});});$('#list-button').click(function(){if($('.card').hasClass('flipped')){$('.card').removeClass('flipped');$(this).find('i').removeClass('icon-arrow-left').addClass('icon-list');}else{$('.card').addClass('flipped');$(this).find('i').removeClass('icon-list').addClass('icon-arrow-left');$('.face.back table').html('');$.get('/track/list',function(events){$.each(events,function(index,event){var row=$('<tr>');var formattedEvent=formatEvent(event);row.append($('<td>').html($('<i>').addClass(event.type.icon)));row.append($('<td>').html(event.time));row.append($('<td>').html(formattedEvent.description));row.append($('<td>').html(formattedEvent.value));$('.face.back table').append(row);});});}
return false;});function formatEvent(event){var result={};switch(event.type.name){case'Feed':result.description=event.type.name+' ('+event.subtype+')';result.value=(event.subtype=='left'||event.subtype=='right')?event.value+' min.':event.value+' oz';break;case'Diaper':result.description='Changed '+(event.subtype=='both'?'wet and dirty':event.subtype)+' diaper';result.value='';break;case'Pump':result.description='Pumped '+event.subtype;result.value=event.value+' oz';break;}
return result;}
function hideAddressBar()
{if(!window.location.hash)
{if(document.height<window.outerHeight)
{document.body.style.height=(window.outerHeight+50)+'px';}
setTimeout(function(){window.scrollTo(0,1);},50);}}
window.addEventListener("load",function(){if(!window.pageYOffset){hideAddressBar();}});window.addEventListener("orientationchange",hideAddressBar);function showNotification(name,error){error=error||false;var selector=error?'#error-notification':'#success-notification';$(selector+' .event-type').html(name);$(selector).stop().css('top','-500px').show().animate({top:'0px'}).delay(8000).animate({top:'-500px'});}
$(function(){var pumpType;$('#pumpModal').on('hidden.bs.modal',function(){$('#pumpModal .pump-types button').removeClass('btn-primary').removeClass('btn-info').addClass('btn-info');$('#pumpModal .pump-options').addClass('hide');});$('#pumpModal .pump-types button').click(function(){$('#pumpModal .pump-types button').removeClass('btn-primary').removeClass('btn-info').addClass('btn-info');$(this).removeClass('btn-info').addClass('btn-primary');$('#pumpModal .pump-options').removeClass('hide');pumpType=$(this).data('value');return false;});$('#pumpModal .pump-options button').click(function(){trackEvent($('#pumpModal'),'Pump',pumpType,$(this).data('value'));return false;});});$(function(){updateStats();setInterval('updateStats()',60);});function updateStats()
{$.get('track/stats',function(response){$('.eventbutton-feed').find('.badge').html(response.feed.time);$('.eventbutton-pump').find('.badge').html(response.pump.time);$('.eventbutton-diaper').find('.badge').html(response.diaper.time);});}
function trackEvent(activeModal,type,subtype,value)
{var spinner=$('<i>').addClass('icon-spinner').addClass('icon-spin').addClass('icon-2x');activeModal.find('.modal-body').append(spinner);$.post('track/new',{type:type,subtype:subtype,value:value},function(response){spinner.remove();if(response.success&&response.success==true){showNotification(type);activeModal.modal('hide');}else{showNotification(type,true);}});}